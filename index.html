<html>

<head>
   <meta charset="UTF-8">
   <meta http-equiv="X-UA-Compatible" content="IE=edge">
   <meta name="viewport" content="width=device-width, initial-scale=1.0">
   <script src="https://cdnjs.cloudflare.com/ajax/libs/crypto-js/4.2.0/crypto-js.min.js" integrity="sha512-a+SUDuwNzXDvz4XrIcXHuCf089/iJAoN4lmrXJg18XnduKK6YlDHNRalv4yd1N40OKI80tFidF+rqTFKGPoWFQ==" crossorigin="anonymous" referrerpolicy="no-referrer"></script>
   <!-- Latest version of msal-browser.js from CDN as of 2022/09 -->
   <script type="text/javascript" src="https://alcdn.msauth.net/browser/2.28.1/js/msal-browser.min.js">
   </script>
   <link rel="stylesheet" href="style.css">
</head>

<body>
   <div>
      <div id="mainCredentials">
         <h1 class="mainCredentialsHeading">Azure AD B2C application credentials <br> to access Dynamics 365 CRM</h1>
         <input name="clientIdInput" id="clientIdInput" type="text" placeholder="ClientID">
         <input name="tenantIdInput" id="tenantIdInput" type="text" placeholder="TenantID">
         <input name="crmUrlInput" id="crmUrlInput" type="text" placeholder="CRM url">
         <a class="youtube" href="https://www.youtube.com/" target="_blank"><img src="/assets/info.svg"
               alt="Info image"> Watch tutorial on YouTube</a>
         <button id="setupButton" disabled onclick="setup()">Set Up</button>
      </div>

      <!-- <div id="message"></div> -->


      <div style="display:none" id="mainCapture">
         <img  id="mainImage" class="personal" src="/assets/person.svg" alt="">
         <h1 id="message">Eljan Simuratli</h1>
         <button id="logoutButton" onclick="signOut()" style="display:none;">
            <svg width="40" height="40" viewBox="0 0 40 40" fill="none" xmlns="http://www.w3.org/2000/svg">
               <path d="M40 20C40 8.9543 31.0457 0 20 0C8.9543 0 0 8.9543 0 20C0 31.0457 8.9543 40 20 40C31.0457 40 40 31.0457 40 20Z" fill="#696D8C"/>
               <path d="M25.1783 16.1558C25.068 16.0517 24.9209 15.9958 24.7693 16.0002C24.6177 16.0047 24.4741 16.0692 24.3701 16.1795C24.266 16.2898 24.2101 16.437 24.2145 16.5886C24.219 16.7401 24.2834 16.8837 24.3938 16.9878L26.9812 19.4289H18.5006C18.3491 19.4289 18.2037 19.4891 18.0966 19.5963C17.9894 19.7035 17.9292 19.8488 17.9292 20.0004C17.9292 20.1519 17.9894 20.2973 18.0966 20.4044C18.2037 20.5116 18.3491 20.5718 18.5006 20.5718H26.9812L24.3938 23.0129C24.3391 23.0644 24.2952 23.1262 24.2644 23.1947C24.2337 23.2632 24.2167 23.3371 24.2145 23.4122C24.2123 23.4872 24.2249 23.562 24.2516 23.6322C24.2783 23.7023 24.3185 23.7666 24.3701 23.8212C24.4216 23.8758 24.4833 23.9198 24.5518 23.9506C24.6203 23.9813 24.6942 23.9983 24.7693 24.0005C24.8443 24.0027 24.9191 23.9901 24.9893 23.9634C25.0595 23.9367 25.1237 23.8964 25.1783 23.8449L28.8115 20.4164C28.8682 20.3629 28.9134 20.2985 28.9443 20.2269C28.9752 20.1554 28.9912 20.0783 28.9912 20.0004C28.9912 19.9224 28.9752 19.8453 28.9443 19.7738C28.9134 19.7023 28.8682 19.6378 28.8115 19.5844L25.1783 16.1558Z" fill="white" stroke="white" stroke-width="0.5"/>
               <path d="M20.1131 26.8571H14.1429V13.1429H20.1131C20.2647 13.1429 20.41 13.0827 20.5172 12.9755C20.6244 12.8683 20.6846 12.723 20.6846 12.5714C20.6846 12.4199 20.6244 12.2745 20.5172 12.1674C20.41 12.0602 20.2647 12 20.1131 12H13.5714C13.4199 12 13.2745 12.0602 13.1674 12.1674C13.0602 12.2745 13 12.4199 13 12.5714V27.4286C13 27.5801 13.0602 27.7255 13.1674 27.8326C13.2745 27.9398 13.4199 28 13.5714 28H20.1131C20.2647 28 20.41 27.9398 20.5172 27.8326C20.6244 27.7255 20.6846 27.5801 20.6846 27.4286C20.6846 27.277 20.6244 27.1317 20.5172 27.0245C20.41 26.9173 20.2647 26.8571 20.1131 26.8571Z" fill="white" stroke="white" stroke-width="0.5"/>
            </svg>
         </button>
         <div id="list"></div>
         
         <div id="fieldsForUser">
            <input class="inputForUser linkedinUrl" type="text" placeholder="Linkedin URL" name="linkedinUrl">
            <input class="inputForUser userName" type="text" placeholder="Username" name="userName">
            <input class="inputForUser jobTitle" type="text" placeholder="Job title" name="jobTitle">
            <input class="inputForUser location" type="text" placeholder="Adress" name="location">
            <input class="inputForUser customer" type="text" placeholder="Work place" name="customer">
            <input class="inputForUser phone" type="text" placeholder="Phone" name="phone">
            <input class="inputForUser tel" type="text" placeholder="Telephone" name="tel">
            <input class="inputForUser email  " type="text" placeholder="Email" name="email">
            <textarea class="comment inputForUser" name="comment" placeholder="Add comment"></textarea>
         </div>

         <div id="fieldsForCompany">
            <input class="inputForUser linkedinCompanyUrl" type="text" placeholder="Company profile link" name="linkedinCompanyUrl">
            <input class="inputForUser companyName" type="text" placeholder="Company name" name="companyName">
            <input class="inputForUser lnSize" type="text" placeholder="Employees on Ln" name="lnSize">
            <input class="inputForUser numberOfWorkers" type="text" placeholder="Company size" name="numberOfWorkers">
            <input class="inputForUser location" type="text" placeholder="Company address" name="location">
            <input class="inputForUser companyUrl" type="text" placeholder="Website" name="companyUrl">
            <textarea class="comment inputForUser" name="comment" placeholder="Add comment"></textarea>
         </div>

         <div class="informationBlock">
            <img src="/assets/info.svg" alt="Information">
            <span>You can complete the empty fields yourself</span>
         </div>
      </div>



      <div style="display:none" id="ifExistUser" class="existTable">
         <img class="personal" src="/assets/person.svg" alt="">
         <h1 id="message">Eljan Simuratli</h1>
         <button id="logoutButton" onclick="signOut()" style="display:none;">
            <img src="/assets/logout.svg" alt="logout">
         </button>
         <div class="informationBlock">
            <img src="/assets/info.svg" alt="Information">
            <span>Data already exists in the CRM</span>
         </div>

         <table style="width:100%">
            <thead>
               <tr>
                  <th style="width: 86px"></td>
                  <th>Linkedin data</td>
                  <th>CRm data</td>
               </tr>
            </thead>
            <tbody>
               <tr>
                  <td >Profile link</td>
                  <td><input placeholder="Profile link"  class="inputForUser linkedinCompanyUrl linkedinCompanyUrlUpdated" name="linkedinUrl"/></td>
                  <td><input readonly  class="existed" placeholder="Profile link"  name="linkedinUrl" /></td>
               </tr>
               <tr>
                  <td>Name</td>
                  <td><input placeholder="Name" class="inputForUser userName userNameUpdated" name="userName"/></td>
                  <td><input class="existed" readonly placeholder="Name" name="fullname"/></td>
               </tr>
               <tr>
                  <td>Job title</td>
                  <td><input placeholder="Job title" class="inputForUser jobTitle jobTitleUpdated" name="jobTitle"/></td>
                  <td><input class="existed" readonly placeholder="Job title" name="jobtitle" /></td>
               </tr>
               <tr>
                  <td>Address</td>
                  <td><input placeholder="Address"  class="inputForUser location locationUpdated" name="location"/></td>
                  <td><input  class="existed" readonly placeholder="Address" name="address1_name" /></td>
               </tr>
               <tr>
                  <td>Company</td>
                  <td><input placeholder="Company" class="inputForUser customer customerUpdated" name="customer" /></td>
                  <td><input class="existedCustomer" readonly placeholder="Company" name="customer"/></td>
               </tr>
               <tr>
                  <td>Work phone</td>
                  <td><input placeholder="Work phone" class="inputForUser phone phoneUpdated" name="phone"/></td>
                  <td><input class="existed" readonly placeholder="Work phone"  name="telephone1"/></td>
               </tr>
               <tr>
                  <td>Personal phone</td>
                  <td><input placeholder="Personal phone" class="inputForUser tel telUpdated" name="tel"/></td>
                  <td><input  class="existed" readonly placeholder="Personal phone" name="mobilephone"/></td>
               </tr>
               <tr>
                  <td>Email</td>
                  <td><input placeholder="Email" class="inputForUser email emailUpdated" name="email"/></td>
                  <td><input class="existed" readonly placeholder="Email" name="emailaddress1" /></td>
               </tr>
               <tr>
                  <td>Personal Email</td>
                  <td><input placeholder="Personal Email" class="inputForUser personalEmail personalEmailUpdated" name="personalEmail"/></td>
                  <td><input class="existed" readonly placeholder="Personal Email" name="emailaddress2" /></td>
               </tr>
               <tr>
                  <td>Comment</td>
                  <td><textarea placeholder="Comment" class="comment inputForUser commentUpdated" name="comment" ></textarea></td>
                  <td><textarea placeholder="Comment" class="existed" name="uds_linkedinusercommentary" readonly></textarea></td>
               </tr>
            </tbody>
         </table>
      </div>


      <div style="display:none" id="ifExistCompany" class="existTable">
         <img class="personal" src="/assets/company.svg" alt="">
         <h1 id="message">Eljan Simuratli</h1>
         <button id="logoutButton" onclick="signOut()" style="display:none;">
            <img src="/assets/logout.svg" alt="logout">
         </button>
         <div class="informationBlock">
            <img src="/assets/info.svg" alt="Information">
            <span>Data already exists in the CRM</span>
         </div>

         <table style="width:100%">
            <thead>
               <tr>
                  <th style="width: 86px"></td>
                  <th>Linkedin data</td>
                  <th>CRm data</td>
               </tr>
            </thead>
            <tbody>
               <tr>
                  <td >Profile link</td>
                  <td><input placeholder="Profile link"  class="inputForUser linkedinCompanyUrl linkedinCompanyUrlUpdated" name="linkedinCompanyUrl"/></td>
                  <td><input readonly  class="existed" placeholder="Profile link"  name="linkedinCompanyUrl" /></td>
               </tr>
               <tr>
                  <td>Company Name</td>
                  <td><input placeholder="Company Name" class="inputForUser companyName companyNameUpdated" name="companyName"/></td>
                  <td><input class="existed" readonly placeholder="Company Name" name="name"/></td>
               </tr>
               <tr>
                  <td>Employees on Ln</td>
                  <td><input placeholder="Employees on Ln" class="inputForUser lnSize lnSizeUpdated" name="lnSize"/></td>
                  <td><input class="existed" readonly placeholder="Employees on Ln" name="uds_linkedinsize" /></td>
               </tr>
               <tr>
                  <td>Company size</td>
                  <td><input placeholder="Address"  class="inputForUser numberofemployees numberofemployeesUpdated" name="numberOfWorkers"/></td>
                  <td><input  class="existed" readonly placeholder="Address" name="numberofemployees" /></td>
               </tr>
               <tr>
                  <td>Company address</td>
                  <td><input placeholder="Company address" class="inputForUser location locationUpdated" name="location" /></td>
                  <td><input class="existed" readonly placeholder="Company address" name="uds_geocodes"/></td>
               </tr>
               <tr>
                  <td>Website</td>
                  <td><input placeholder="Website" class="inputForUser websiteurl websiteurlUpdated" name="companyUrl"/></td>
                  <td><input class="existed" readonly placeholder="Website"  name="websiteurl"/></td>
               </tr>
               <tr>
                  <td>Comment</td>
                  <td><textarea placeholder="Comment" class="comment inputForUser commentUpdated" name="comment" ></textarea></td>
                  <td><textarea placeholder="Comment" class="existed" name="uds_linkedincompanycommentary" readonly></textarea></td>
               </tr>
            </tbody>
         </table>
      </div>



      <div class="successMessageIndividual">
         <img src="./assets/success.png" alt="">
         Success!
      </div>

      <div id="loginWithButton">
         <img src="/assets/BigInfo.png" alt="Big info button">
         <h1 class="loginWithButtonHeading">Log In with your Microsoft Account </h1>
         <button id="loginButton" onclick="signIn()">Log in</button>
         <a class="youtube" href="https://www.youtube.com/" target="_blank"><img src="/assets/info.svg" alt="Info image"> Watch tutorial on YouTube</a>
      </div>




      <div class="buttonContainer">
         <!-- <button id="getAccountsButton" onclick="getAccounts(writeTable)" style="display:none;">Get data</button> -->
         <button id="sendAccountsButton" onclick="sendAccounts(writeTable)" style="display:none;">Capture</button>
         <button id="goToCRMButton" onclick="goToCrm()" style="display:none;">Go to CRM</button>
         <button id="updateDataButton" onclick="updateData()" style="display:none;">Update data</button>
      </div>



   </div>

   <script src="./main.js"></script>
  
</body>

</html>